{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///home/thib/Grigou_v3/git/src/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\nexport default pool;\n\nexport interface Transaction {\n  id: number;\n  type: 'income' | 'outcome';\n  amount: number;\n  description: string;\n  category: string | null;\n  date: string;\n  created_at: Date;\n  updated_at: Date;\n}\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAC5C;uCAEe","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/thib/Grigou_v3/git/src/app/api/transactions/route.ts"],"sourcesContent":["// Ce fichier doit être placé dans : app/api/transactions/route.ts\nimport { NextRequest, NextResponse } from 'next/server';\nimport pool from '@/lib/db';\n\nexport async function GET(request: NextRequest) {\n  try {\n    const searchParams = request.nextUrl.searchParams;\n    const startDate = searchParams.get('startDate');\n    const endDate = searchParams.get('endDate');\n\n    let query = 'SELECT * FROM transactions';\n    const params: any[] = [];\n\n    if (startDate && endDate) {\n      query += ' WHERE date >= $1 AND date <= $2';\n      params.push(startDate, endDate);\n    }\n\n    query += ' ORDER BY date DESC';\n\n    console.log('Executing query:', query);\n    console.log('With parameters:', params);\n\n    const result = await pool.query(query, params);\n\n    // Convertir les montants en nombres\n    const transactions = result.rows.map(row => ({\n      ...row,\n      amount: parseFloat(row.amount)\n    }));\n    console.log('Fetched transactions:');\n    console.log(transactions);\n    return NextResponse.json(transactions);\n  } catch (error) {\n    console.error('Error fetching transactions:', error);\n    return NextResponse.json(\n      { error: 'Erreur lors de la récupération des transactions' },\n      { status: 500 }\n    );\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const {\n      type,\n      amount,\n      description,\n      category,\n      date,\n      is_recurring,\n      recurrence_type,\n      recurrence_end_date\n    } = body;\n\n    if (!type || !amount || !description || !date) {\n      return NextResponse.json(\n        { error: 'Tous les champs requis doivent être remplis' },\n        { status: 400 }\n      );\n    }\n\n    if (type !== 'income' && type !== 'outcome') {\n      return NextResponse.json(\n        { error: 'Le type doit être \"income\" ou \"outcome\"' },\n        { status: 400 }\n      );\n    }\n\n    // Insertion avec les champs de récurrence\n    const result = await pool.query(\n      `INSERT INTO transactions \n       (type, amount, description, category, date, is_recurring, recurrence_type, recurrence_end_date) \n       VALUES ($1, $2, $3, $4, $5, $6, $7, $8) \n       RETURNING *`,\n      [\n        type,\n        amount,\n        description,\n        category,\n        date,\n        is_recurring || false,\n        is_recurring ? recurrence_type : null,\n        is_recurring && recurrence_end_date ? recurrence_end_date : null\n      ]\n    );\n\n    const transaction = {\n      ...result.rows[0],\n      amount: parseFloat(result.rows[0].amount)\n    };\n\n    return NextResponse.json(transaction, { status: 201 });\n  } catch (error) {\n    console.error('Error creating transaction:', error);\n    return NextResponse.json(\n      { error: 'Erreur lors de la création de la transaction' },\n      { status: 500 }\n    );\n  }\n}"],"names":[],"mappings":"AAAA,kEAAkE;;;;;;;AAClE;AACA;;;;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;QACjD,MAAM,YAAY,aAAa,GAAG,CAAC;QACnC,MAAM,UAAU,aAAa,GAAG,CAAC;QAEjC,IAAI,QAAQ;QACZ,MAAM,SAAgB,EAAE;QAExB,IAAI,aAAa,SAAS;YACxB,SAAS;YACT,OAAO,IAAI,CAAC,WAAW;QACzB;QAEA,SAAS;QAET,QAAQ,GAAG,CAAC,oBAAoB;QAChC,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,MAAM,SAAS,MAAM,6HAAI,CAAC,KAAK,CAAC,OAAO;QAEvC,oCAAoC;QACpC,MAAM,eAAe,OAAO,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;gBAC3C,GAAG,GAAG;gBACN,QAAQ,WAAW,IAAI,MAAM;YAC/B,CAAC;QACD,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC;QACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAkD,GAC3D;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACJ,IAAI,EACJ,MAAM,EACN,WAAW,EACX,QAAQ,EACR,IAAI,EACJ,YAAY,EACZ,eAAe,EACf,mBAAmB,EACpB,GAAG;QAEJ,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,CAAC,MAAM;YAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA8C,GACvD;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,SAAS,YAAY,SAAS,WAAW;YAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0C,GACnD;gBAAE,QAAQ;YAAI;QAElB;QAEA,0CAA0C;QAC1C,MAAM,SAAS,MAAM,6HAAI,CAAC,KAAK,CAC7B,CAAC;;;kBAGW,CAAC,EACb;YACE;YACA;YACA;YACA;YACA;YACA,gBAAgB;YAChB,eAAe,kBAAkB;YACjC,gBAAgB,sBAAsB,sBAAsB;SAC7D;QAGH,MAAM,cAAc;YAClB,GAAG,OAAO,IAAI,CAAC,EAAE;YACjB,QAAQ,WAAW,OAAO,IAAI,CAAC,EAAE,CAAC,MAAM;QAC1C;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,aAAa;YAAE,QAAQ;QAAI;IACtD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+C,GACxD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}